

A. Конечный автомат


Ограничение времени
0.1 секунда


Ограничение памяти
1Mb


Ввод
стандартный ввод или input.txt


Вывод
стандартный вывод или output.txt





Вам предстоит реализовать детерминированный конечный автомат по описанию его переходов и протестировать его работу. Для простоты
            алфавит автомата ограничен строчными буквами латинского алфавита (a-z).
         
Формат ввода

Первая строка содержит число N (1 <= N <= 3000) - число состояний автомата. Следующие N строк содержат описания очередного
            состояния:0 или 1 - является ли состояние допускающим (1, если допускает) - см. также Примечание,T (0 <= T <= 26) - число переходов из данного состояния,далее T пар описаний переходов: символ и номер состояния.
         Следующая за описанием автомата строка содержит число M (1 <= M <= 2000) - число строк, на которых полученный автомат следует
         протестировать. Следующие M строк содержат тестовые входы и состоят строго из строчных букв латинского алфавита (a-z). Длина
         каждого входа находится в пределах от 1 до 15000.
      
Состояния автомата нумеруются с нуля, нулевое состояние автомата является его начальным состоянием.

Формат вывода

Выход должен содержать M + 1 строк с числами 0 или 1: в первой строке выхода следует следует вывести 1, если автомат допускает пустую строку, либо 0, если не допускает; в следующих M строках следует вывести 1, если автомат допускает очередную строку из тестового входа, либо 0, если не допускает.
         
Пример



Ввод
Вывод




2
1 1 a 1
0 1 b 0
5
a
b
ab
aba
abab
1
0
0
1
0
1




Примечания

Часто для более экономной записи у детерминированных автоматов не пишут переходы, которые гарантированно ведут их в недопускающее
            состояние. При этом подразумевается, что все недостающие переходы определены и ведут в некоторое "подразумеваемое" недопускающее
            состояние, из которого автомат никогда больше не выходит. 
         
