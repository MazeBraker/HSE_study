<div class="problem-statement">
<div class="header">
<h1 class="title">F. Три строки</h1>
<table>
<tr class="time-limit">
<td class="property-title">Ограничение времени</td>
<td>3 секунды</td>
</tr>
<tr class="memory-limit">
<td class="property-title">Ограничение памяти</td>
<td>512Mb</td>
</tr>
<tr class="input-file">
<td class="property-title">Ввод</td>
<td colspan="1">стандартный ввод или input.txt</td>
</tr>
<tr class="output-file">
<td class="property-title">Вывод</td>
<td colspan="1">стандартный вывод или output.txt</td>
</tr>
</table>
</div>
<h2></h2>
<div class="legend"><span style="">
<p>В новом учебном году школа, в которой обучается 7-классница Андреева Анна Андреевна, решилась на беспрецедентные меры по повышению
            знаний учащихся: каждый преподаватель школы должен помимо основных занятий прочитать хотя бы один годовой спецкурс. Темы спецкурсов
            преподаватели подобрали самые разные и интересные, а чтобы все учащиеся окончательно побросали свои внешкольные дела и с увлечением
            слушали новые курсы, их решено было сделать обязательными, а в конце еще и ставить дополнительную оценку в дневник.
         </p></span><p>Аня тщательно следит, чтобы в ее дневнике появлялись лишь оценки, строго большие четырех, поэтому, выкроив время между посещением
         бассейна и музыкальной школой, она села делать домашнее задание по спецкурсу «История магии», куда они с подружками ходят
         по средам, сразу после математики.
      </p>
<p>На последнем занятии рассказывалось, что все заклинания представляют собой конечные последовательности строчных латинских
         букв (возможно, пустые). Более того, история магии такая длинная и насыщенная, а маги в стародавние времена трудились столь плодотворно, что в наше время можно считать, что каждая конечная
         последовательность строчных латинских букв (в том числе и пустая) обязательно является заклинанием.
      </p>
<p>После этого преподаватель рассказал, что в древности магические ордена с одной стороны беспокоились о передаче и сохранении
         своих знаний, а с другой ни в коем случае не желали делиться своими результатами с кем бы то ни было, вследствие чего в ордене Данных Строк применялся следующий метод
         шифрования. Чтобы сохранить три заклинания <span class="tex-math-text">A</span>, <span class="tex-math-text">B</span> и <span class="tex-math-text">C</span>, из них формировали три строки: <span class="tex-monospace">A' = *A*B*</span>, <span class="tex-monospace">B' = *C*A*</span>, <span class="tex-monospace">C' = *B*C*</span>, где вместо каждого символа '<span class="tex-monospace">*</span>' подставлялась любая последовательность строчных латинских букв (возможно, пустая). Дополнительно требовалось, чтобы длины
         всех трех полученных строк были равны некоторому заранее выбранному числу <span class="tex-math-text">N</span>. Например, строки <span class="tex-math-text">A =</span> «<span class="tex-monospace">a</span>», <span class="tex-math-text">B =</span> «<span class="tex-monospace">tb</span>» и <span class="tex-math-text">C =</span> «<span class="tex-monospace">c</span>» могли быть зашифрованы при помощи строк <span class="tex-monospace">A' = «agtb»</span>, <span class="tex-monospace">B' = «icea»</span> и <span class="tex-monospace">C' = «tbhc»</span>.
      </p>
<p>В качестве домашнего задания преподаватель предложил каждому школьнику попытаться расшифровать по одному результату такой
         записи. Ане даны три строки <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/QSc=.png"/></span>, <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/Qic=.png"/></span> и <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/Qyc=.png"/></span>, вероятно полученные из каких-то заклинаний <span class="tex-math-text">A</span>, <span class="tex-math-text">B</span> и <span class="tex-math-text">C</span> описанными выше преобразованиями. Поскольку некоторые наборы из трех строк могли быть получены и больше чем из одного варианта
         исходных заклинаний <span class="tex-math-text">A</span>, <span class="tex-math-text">B</span> и <span class="tex-math-text">C</span>, Ане необходимо всего лишь найти максимально возможную суммарную длину исходных заклинаний.
      </p>
<p><span style="font-weight:bold;">Указание.</span> Используйте автомат Ахо — Корасик.
      </p>
</div>
<h2>Формат ввода</h2>
<div class="input-specification"><span style="">
<p>Первая строка входного файла содержит единственное целое число <span class="tex-math-text">N</span> (<span class="tex-math-text">1 ≤ N ≤ 2 000</span>) — длину каждой из входных строк. В следующих трех строках содержатся строки <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/QSc=.png"/></span>, <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/Qic=.png"/></span> и <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/Qyc=.png"/></span>, каждая из которых состоит из <span class="tex-math-text">N</span> строчных латинских букв.
         </p></span></div>
<h2>Формат вывода</h2>
<div class="output-specification"><span style="">
<p>Выведите единственное целое число — ответ на поставленную задачу. Если не существует заклинаний <span class="tex-math-text">A</span>, <span class="tex-math-text">B</span> и <span class="tex-math-text">C</span>, из которых можно получить данные три строки <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/QSc=.png"/></span>, <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/Qic=.png"/></span> и <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/Qyc=.png"/></span>, то выведите ноль.
         </p></span></div>
<h3>Пример 1</h3>
<table class="sample-tests">
<thead>
<tr>
<th>Ввод</th>
<th>Вывод</th>
</tr>
</thead>
<tbody>
<tr>
<td><pre>2
ac
ba
cb
</pre></td>
<td><pre>3
</pre></td>
</tr>
</tbody>
</table>
<h3>Пример 2</h3>
<table class="sample-tests">
<thead>
<tr>
<th>Ввод</th>
<th>Вывод</th>
</tr>
</thead>
<tbody>
<tr>
<td><pre>4
agtb
icea
tbhc
</pre></td>
<td><pre>4
</pre></td>
</tr>
</tbody>
</table>
<h3>Пример 3</h3>
<table class="sample-tests">
<thead>
<tr>
<th>Ввод</th>
<th>Вывод</th>
</tr>
</thead>
<tbody>
<tr>
<td><pre>3
abc
cde
dea
</pre></td>
<td><pre>2
</pre></td>
</tr>
</tbody>
</table>
</div>