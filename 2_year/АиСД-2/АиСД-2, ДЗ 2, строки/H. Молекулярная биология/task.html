<div class="problem-statement">
<div class="header">
<h1 class="title">H. Молекулярная биология</h1>
<table>
<tr class="time-limit">
<td class="property-title">Ограничение времени</td>
<td>3 секунды</td>
</tr>
<tr class="memory-limit">
<td class="property-title">Ограничение памяти</td>
<td>256Mb</td>
</tr>
<tr class="input-file">
<td class="property-title">Ввод</td>
<td colspan="1">стандартный ввод или input.txt</td>
</tr>
<tr class="output-file">
<td class="property-title">Вывод</td>
<td colspan="1">стандартный вывод или output.txt</td>
</tr>
</table>
</div>
<h2></h2>
<div class="legend"><span style="">
<p>Напомним, что важнейшей задачей молекулярной биологии является изучение различных белков. В общем случае один и тот же белок
            имеет одну из четырех форм (первичная, вторичная, третичная и четвертичная структура), простейшей с точки зрения химии является
            первичная, которую мы и рассмотрим.
         </p></span><p>Белок представляет собой последовательность аминокислот, соединенных пептидной связью (эта связь одинакова между любыми двумя
         аминокислотами, поэтому рассматриваться она не будет). Аминокислота, как следует из названия, — это органическое соединение, в молекуле которого одновременно содержатся карбоксильные и аминные группы. Для простоты будем
         считать, что аминокислота состоит из химических элементов, каждый элемент будем обозначать маленькой латинской буквой, таким
         образом, аминокислота однозначно определяется строкой из нескольких латинских букв. Безусловно, не любая последовательность
         элементов является аминокислотой.
      </p>
<p>Для каждого организма известен большой список аминокислот, которые могут быть синтезированы в организме такого типа. Для удобства
         транскрипции (это один из этапов синтеза РНК), ни одна аминокислота не является началом другой.
      </p>
<p>Одна из часто встречающихся задач заключается в том, чтобы понять, мог ли данный белок быть синтезирован в данном организме
         (это позволяет понять по белку, где он был синтезирован: у человека, у гриба и пр.). Для этого нужно проверить, все ли аминокислоты,
         из которых он состоит, могли быть синтезированы. Однако, часто белок содержит лишние элементы (например, к белку из-за обилия
         атомов водорода очень часто присоединяются молекулы воды), поэтому задача сводится к изучению фрагментов этого белка. Проводят
         как отдельные проверки каких-то фрагментов, так и целые серии проверок случайных фрагментов.
      </p>
<p>Более формально, вам дан словарь из аминокислот, каждая из которых представляет собой строку из маленьких латинских букв,
         и белóк, который также представляет собой строку из маленьких латинских букв. Необходимо ответить на несколько вопросов вида
         «мог ли фрагмент белка с позиции <span class="tex-math-text">l</span> по <span class="tex-math-text">r</span> быть синтезирован из данных аминокислот», т. е. можно ли данный фрагмент разбить на слова из словаря. В случае положительного ответа, необходимо предъявить минимальное
         количество слов в таком разбиении.
      </p>
<p><span style="font-weight:bold;">Указание.</span> Используйте автомат Ахо — Корасик. Отрезку строки соответствует путь в графе.
      </p>
</div>
<h2>Формат ввода</h2>
<div class="input-specification"><span style="">
<p>В первой строке входного файла содержится одно число <span class="tex-math-text">N</span> — количество аминокислот. Далее следует <span class="tex-math-text">N</span> непустых строк, каждая из которых является описанием аминокислоты. Суммарная длина строк <span class="tex-math-text">S</span> не превосходит <span class="tex-math-text">10<sup>6</sup></span>.
         </p></span><p>В следующей строке содержится исходный белок, длина <span class="tex-math-text">L</span> которого не превосходит <span class="tex-math-text">10<sup>6</sup></span>.
      </p>
<p>Далее содержится число <span class="tex-math-text">M</span> — количество простых запросов (<span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/MCBcbGVxc2xhbnQgTSBcbGVxc2xhbnQgMTBeNQ==.png"/></span>). Каждый простой запрос описывается двумя числами — <span class="tex-math-text">l</span> и <span class="tex-math-text">r</span>, (<span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/MSBcbGVxc2xhbnQgbCBcbGVxc2xhbnQgciBcbGVxc2xhbnQgTA==.png"/></span>), обозначающими искомый фрагмент <span class="tex-math-text">[l, r]</span>, который необходимо разбить.
      </p>
<p>Далее содержится число <span class="tex-math-text">K</span> — количество запросов-серий (<span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/MCBcbGVxc2xhbnQgSyBcbGVxc2xhbnQgMTBeNQ==.png"/></span>, в некоторых группах тестов запросы-серии отсутствуют и <span class="tex-math-text">K=0</span>). Каждая серия описывается восемью целыми числами <span class="tex-math-text">T, A, B, C, D, E, l<sub>1</sub>, r<sub>1</sub></span> (<span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/MSBcbGVxc2xhbnQgQSwgQiwgQywgRCBcbGVxc2xhbnQgMTAw.png"/></span>, <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/MSBcbGVxc2xhbnQgVCwgRSwgbF8xLCByXzEgXGxlcXNsYW50IDEwXjc=.png"/></span>). Такая серия описывает <span class="tex-math-text">T</span> простых запросов. Запрос с номером <span class="tex-math-text">i</span> выглядит как фрагмент <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/W1xtaW4obF9pIFxibW9kIEwgKyAxLCByX2kgXGJtb2QgTCArIDEpLCBcbWF4KGxfaSBcYm1vZCBMICsgMSwgcl9pIFxibW9kIEwgKyAxKV0=.png"/></span>. Числа <span class="tex-math-text">l<sub>i</sub></span> и <span class="tex-math-text">r<sub>i</sub></span> для <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/aSBcZ2Vxc2xhbnQgMg==.png"/></span> определяются следующим образом. Пусть <span class="tex-math-text">ans</span> обозначает ответ на запрос с номером <span class="tex-math-text">i-1</span> в этой серии. Тогда <span class="tex-math-inline"><img class="tex-math" src="/testsys/tex/render/bF9pID0gKEEgXGNkb3QgbF97aS0xfSArIEIpIFxibW9kIEUsIHJfaSA9IChDIFxjZG90IHJfe2ktMX0gKyBEICsgYW5zKSBcYm1vZCBF.png"/></span>. Суммарное число запросов в сериях не превосходит <span class="tex-math-text">10<sup>7</sup></span>.
      </p>
<p>Все строки во входном файле состоят только из маленьких латинских букв. Гарантируется. что ни одна аминокислота не является
         префиксом другой.
      </p>
</div>
<h2>Формат вывода</h2>
<div class="output-specification"><span style="">
<p>Для каждого простого запроса выведите единственное число — минимальное число аминокислот, на которое разбивается соответсвующий фрагмент. В случае, если разбиения не существует, ответом
            на запрос является число <span class="tex-math-text">-1</span>. Для каждой серии выведите одно число — сумму ответов на все запросы, для которых ответ существует (то есть не равен <span class="tex-math-text">-1</span>), взятую по модулю <span class="tex-math-text">E</span>.
         </p></span></div>
<h3>Пример 1</h3>
<table class="sample-tests">
<thead>
<tr>
<th>Ввод</th>
<th>Вывод</th>
</tr>
</thead>
<tbody>
<tr>
<td><pre>2
abra
cadabra
abracadabra
6
1 4
8 11
4 8
5 11
1 11
3 6
0
</pre></td>
<td><pre>1
1
-1
1
2
-1
</pre></td>
</tr>
</tbody>
</table>
<h3>Пример 2</h3>
<table class="sample-tests">
<thead>
<tr>
<th>Ввод</th>
<th>Вывод</th>
</tr>
</thead>
<tbody>
<tr>
<td><pre>2
ab
ba
ababab
0
1
10 1 2 3 4 5 6 7
</pre></td>
<td><pre>3
</pre></td>
</tr>
</tbody>
</table>
</div>