

H. Молекулярная биология


Ограничение времени
3 секунды


Ограничение памяти
256Mb


Ввод
стандартный ввод или input.txt


Вывод
стандартный вывод или output.txt





Напомним, что важнейшей задачей молекулярной биологии является изучение различных белков. В общем случае один и тот же белок
            имеет одну из четырех форм (первичная, вторичная, третичная и четвертичная структура), простейшей с точки зрения химии является
            первичная, которую мы и рассмотрим.
         Белок представляет собой последовательность аминокислот, соединенных пептидной связью (эта связь одинакова между любыми двумя
         аминокислотами, поэтому рассматриваться она не будет). Аминокислота, как следует из названия, — это органическое соединение, в молекуле которого одновременно содержатся карбоксильные и аминные группы. Для простоты будем
         считать, что аминокислота состоит из химических элементов, каждый элемент будем обозначать маленькой латинской буквой, таким
         образом, аминокислота однозначно определяется строкой из нескольких латинских букв. Безусловно, не любая последовательность
         элементов является аминокислотой.
      
Для каждого организма известен большой список аминокислот, которые могут быть синтезированы в организме такого типа. Для удобства
         транскрипции (это один из этапов синтеза РНК), ни одна аминокислота не является началом другой.
      
Одна из часто встречающихся задач заключается в том, чтобы понять, мог ли данный белок быть синтезирован в данном организме
         (это позволяет понять по белку, где он был синтезирован: у человека, у гриба и пр.). Для этого нужно проверить, все ли аминокислоты,
         из которых он состоит, могли быть синтезированы. Однако, часто белок содержит лишние элементы (например, к белку из-за обилия
         атомов водорода очень часто присоединяются молекулы воды), поэтому задача сводится к изучению фрагментов этого белка. Проводят
         как отдельные проверки каких-то фрагментов, так и целые серии проверок случайных фрагментов.
      
Более формально, вам дан словарь из аминокислот, каждая из которых представляет собой строку из маленьких латинских букв,
         и белóк, который также представляет собой строку из маленьких латинских букв. Необходимо ответить на несколько вопросов вида
         «мог ли фрагмент белка с позиции l по r быть синтезирован из данных аминокислот», т. е. можно ли данный фрагмент разбить на слова из словаря. В случае положительного ответа, необходимо предъявить минимальное
         количество слов в таком разбиении.
      
Указание. Используйте автомат Ахо — Корасик. Отрезку строки соответствует путь в графе.
      

Формат ввода

В первой строке входного файла содержится одно число N — количество аминокислот. Далее следует N непустых строк, каждая из которых является описанием аминокислоты. Суммарная длина строк S не превосходит 106.
         В следующей строке содержится исходный белок, длина L которого не превосходит 106.
      
Далее содержится число M — количество простых запросов (). Каждый простой запрос описывается двумя числами — l и r, (), обозначающими искомый фрагмент [l, r], который необходимо разбить.
      
Далее содержится число K — количество запросов-серий (, в некоторых группах тестов запросы-серии отсутствуют и K=0). Каждая серия описывается восемью целыми числами T, A, B, C, D, E, l1, r1 (, ). Такая серия описывает T простых запросов. Запрос с номером i выглядит как фрагмент . Числа li и ri для  определяются следующим образом. Пусть ans обозначает ответ на запрос с номером i-1 в этой серии. Тогда . Суммарное число запросов в сериях не превосходит 107.
      
Все строки во входном файле состоят только из маленьких латинских букв. Гарантируется. что ни одна аминокислота не является
         префиксом другой.
      

Формат вывода

Для каждого простого запроса выведите единственное число — минимальное число аминокислот, на которое разбивается соответсвующий фрагмент. В случае, если разбиения не существует, ответом
            на запрос является число -1. Для каждой серии выведите одно число — сумму ответов на все запросы, для которых ответ существует (то есть не равен -1), взятую по модулю E.
         
Пример 1



Ввод
Вывод




2
abra
cadabra
abracadabra
6
1 4
8 11
4 8
5 11
1 11
3 6
0

1
1
-1
1
2
-1




Пример 2



Ввод
Вывод




2
ab
ba
ababab
0
1
10 1 2 3 4 5 6 7

3




